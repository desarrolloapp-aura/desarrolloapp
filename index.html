<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluaci√≥n de Proveedores</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="supabase-service.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1 id="tituloPrincipal">Evaluaci√≥n de Proveedores</h1>
        </header>

        <!-- Secci√≥n Informativa -->
        <section class="info-section">
            <div class="info-content">
                <h2>üìã ¬øQu√© es esta evaluaci√≥n?</h2>
                <p id="descripcionEvaluacion">Este sistema permite evaluar el desempe√±o de nuestros proveedores mediante un proceso estructurado y objetivo, considerando diferentes aspectos seg√∫n el tipo de proveedor (Producto o Servicio).</p>
                
                <h3>üéØ Objetivo</h3>
                <p id="objetivoEvaluacion">Medir y mejorar continuamente la calidad de nuestros proveedores, asegurando que cumplan con los est√°ndares requeridos en t√©rminos de:</p>
                <ul>
                    <li>Calidad de productos/servicios</li>
                    <li>Cumplimiento de plazos</li>
                    <li>Comunicaci√≥n y respuesta</li>
                    <li>Certificaciones y cumplimiento normativo</li>
                </ul>

                <h3>üìä ¬øC√≥mo funciona la evaluaci√≥n?</h3>
                <div class="process-steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <strong>Selecci√≥n del Evaluador</strong>
                            <p>Cada evaluador tiene asignados proveedores espec√≠ficos seg√∫n su √°rea de responsabilidad.</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <strong>Tipo de Proveedor</strong>
                            <p>Selecciona si el proveedor es de <strong>PRODUCTO</strong> o <strong>SERVICIO</strong> ya que cada tipo tiene criterios de evaluaci√≥n diferentes.</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <strong>Evaluaci√≥n por √çtems</strong>
                            <p>Cada √≠tem se califica con: <strong>25%</strong> <strong>50%</strong> <strong>75%</strong> o <strong>100%</strong> seg√∫n el cumplimiento observado.</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <strong>C√°lculo Autom√°tico</strong>
                            <p>El sistema calcula autom√°ticamente el resultado final ponderado, considerando la importancia de cada √≠tem.</p>
                        </div>
                    </div>
                </div>

                <h3>üìà Criterios de Evaluaci√≥n</h3>
                
                <div class="criteria-box" id="criteriaProducto">
                    <h4>üü¶ Proveedores de PRODUCTO</h4>
                    <p id="textoProducto">Se eval√∫an <span id="cantidadProducto">7</span> aspectos con las siguientes ponderaciones:</p>
                    <ul id="listaProducto">
                        <!-- Se llena din√°micamente desde la configuraci√≥n -->
                    </ul>
                </div>

                <div class="criteria-box" id="criteriaServicio">
                    <h4>üü© Proveedores de SERVICIO</h4>
                    <p id="textoServicio">Se eval√∫an <span id="cantidadServicio">6</span> aspectos con las siguientes ponderaciones:</p>
                    <ul id="listaServicio">
                        <!-- Se llena din√°micamente desde la configuraci√≥n -->
                    </ul>
                </div>

                <div class="info-note">
                    <strong>‚ö†Ô∏è Importante:</strong> Cada evaluador solo puede evaluar a los proveedores que tiene asignados. Una vez evaluado un proveedor, no aparecer√° nuevamente en la lista hasta que se elimine la evaluaci√≥n anterior.
                </div>
            </div>
        </section>

        <form id="evaluationForm">
            <!-- Secci√≥n 1: Evaluador -->
            <section class="form-section">
                <h2>1. Seleccione el Evaluador</h2>
                <select id="evaluador" required>
                    <option value="">-- Seleccione un evaluador --</option>
                </select>
            </section>

            <!-- Secci√≥n 1.5: Fecha de Evaluaci√≥n -->
            <section class="form-section">
                <h2>1.5. Fecha de Evaluaci√≥n</h2>
                <input type="date" id="anioEvaluacion" required style="width: 100%; padding: 12px; border: 2px solid #667eea; border-radius: 8px; font-size: 1rem;">
                <small style="color: #666; display: block; margin-top: 5px;">Seleccione la fecha para la cual est√° realizando la evaluaci√≥n (esta fecha se guardar√° en la base de datos)</small>
            </section>

            <!-- Secci√≥n 2: Tipo de Proveedor -->
            <section class="form-section">
                <h2>2. Tipo de Proveedor</h2>
                <div class="radio-group">
                    <label>
                        <input type="radio" name="tipoProveedor" value="PRODUCTO" required>
                        <span>PRODUCTO</span>
                    </label>
                    <label>
                        <input type="radio" name="tipoProveedor" value="SERVICIO" required>
                        <span>SERVICIO</span>
                    </label>
                </div>
            </section>

            <!-- Secci√≥n 3: Proveedor -->
            <section class="form-section">
                <h2>3. Seleccione el Proveedor</h2>
                <select id="proveedor" required>
                    <option value="">-- Primero seleccione el tipo de proveedor --</option>
                </select>
            </section>

            <!-- Secci√≥n 3.5: Correo del Proveedor -->
            <section class="form-section" id="correoSection" style="display: none;">
                <h2>3.5. Correo Electr√≥nico del Proveedor</h2>
                <input type="email" id="correoProveedor" placeholder="ejemplo@proveedor.com" required>
                <small style="color: #666; display: block; margin-top: 5px;">Ingrese el correo electr√≥nico del proveedor para enviar la evaluaci√≥n</small>
            </section>

            <!-- Secci√≥n 4: √çtems de Evaluaci√≥n -->
            <section class="form-section" id="itemsSection" style="display: none;">
                <h2 id="itemsTitle">4. √çtems de Evaluaci√≥n</h2>
                <div id="itemsContainer"></div>
            </section>

            <!-- Resultado Final -->
            <section class="form-section" id="resultSection" style="display: none;">
                <h2>Resultado Final</h2>
                <div class="result-box">
                    <div class="result-label">Resultado Ponderado:</div>
                    <div class="result-value" id="resultadoFinal">0%</div>
                </div>
            </section>

            <!-- Botones -->
            <div class="button-group">
                <button type="submit" id="guardarBtn"><span>üíæ Guardar Evaluaci√≥n</span></button>
                <button type="button" id="limpiarBtn"><span>üóëÔ∏è Limpiar Formulario</span></button>
            </div>
        </form>
    </div>

    <script src="script.js"></script>
    <!-- Scripts en orden: Supabase -> Config -> Service -> Main -->
</body>
</html>

